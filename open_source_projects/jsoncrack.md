# [jsoncrack.com](jsoncrack.com) â€” jsonå¯è§†åŒ–å·¥å…·

![https://github.com/AykutSarac/jsoncrack.com/raw/main/public/assets/jsoncrack-screenshot.webp](https://github.com/AykutSarac/jsoncrack.com/raw/main/public/assets/jsoncrack-screenshot.webp)

è¿™ä¸ªé¡¹ç›®çš„æ ¸å¿ƒåŠŸèƒ½éå¸¸æ¸…æ™°â€”â€”â€”JSONçš„å¯è§†åŒ–ã€‚è™½ç„¶æ•´ä½“ç•Œé¢å¾ˆåƒä¸€ä¸ªç¼–è¾‘å™¨ï¼Œå·¦ä¾§æœ‰å¾ˆå¤šæŒ‰é’®ï¼Œä½†å®ƒä»¬å¹¶éå¤§å‹çš„åŠŸèƒ½æ¨¡å—ï¼Œè€Œæ˜¯ä¸€äº›å¿«æ·çš„é…ç½®é¡¹ï¼Œå¦‚å¯¼å…¥æ–‡ä»¶ã€æ ‘çŠ¶å›¾çš„æ—‹è½¬ç­‰ã€‚å› æ­¤ï¼ˆæˆ‘ä¸€å¼€å§‹è§‰å¾—ï¼‰ä¸“æ³¨çœ‹çœ‹å®ƒçš„æ ¸å¿ƒåŠŸèƒ½å³å¯ã€‚

ä½œä¸ºå‰ç«¯å¸¸ç”¨çš„é…ç½®æ–‡ä»¶æ ¼å¼ï¼ŒJSONç»“æ„æœ¬èº«æ˜¯æ¸…æ™°å¥½ç”¨çš„ï¼Œä½†ä¹Ÿæ¶ä¸ä½é“¾è¡¨å¤ªé•¿ã€æ·±åº¦å¤ªå¤§â€¦â€¦ æœ‰æ—¶æƒ³æŠŠæ¡ä¸€ä¸ªJSONæ–‡ä»¶çš„æ ¸å¿ƒç»“æ„ï¼Œå±å®æœ‰ç‚¹è´¹çœ¼ç›ã€‚jsoncrack.comå°±å±äºè¿™ç§ï¼Œå¹³æ—¶è§‰å¾—æ²¡å•¥ç”¨ï¼ŒJSONæ–‡ä»¶é€¼ç–¯ä½ åç–¯ç‹‚å…¨ç½‘å¯»æ‰¾çš„ç¥å™¨ã€‚

é¦–å…ˆï¼Œè¿˜æ˜¯æƒ³æ¥æ•´ä½“çœ‹çœ‹å®ƒçš„é¡¹ç›®ç»“æ„ã€‚

```shell
.
â”œâ”€â”€ CODE_OF_CONDUCT.md
â”œâ”€â”€ CONTRIBUTING.md
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â”œâ”€â”€ default.conf
â”œâ”€â”€ jest.config.ts
â”œâ”€â”€ jest.setup.ts
â”œâ”€â”€ next-env.d.ts
â”œâ”€â”€ next.config.js
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ yarn.lock
â”œâ”€â”€ public
â”‚   â””â”€â”€ assets
â””â”€â”€ src
    â”œâ”€â”€ components
    â”‚   â”œâ”€â”€ Button
    â”‚   â”œâ”€â”€ CarbonAds
    â”‚   â”œâ”€â”€ CustomNode
    â”‚   â”œâ”€â”€ ErrorContainer
    â”‚   â”œâ”€â”€ GoogleAnalytics
    â”‚   â”œâ”€â”€ Graph
    â”‚   â”œâ”€â”€ Input
    â”‚   â”œâ”€â”€ Loading
    â”‚   â”œâ”€â”€ Modal
    â”‚   â”œâ”€â”€ MonacoEditor
    â”‚   â”œâ”€â”€ Producthunt
    â”‚   â”œâ”€â”€ SearchInput
    â”‚   â”œâ”€â”€ SeoTags
    â”‚   â”œâ”€â”€ Sidebar
    â”‚   â”œâ”€â”€ Sponsors
    â”‚   â”œâ”€â”€ SupportButton
    â”‚   â”œâ”€â”€ Toggle
    â”‚   â”œâ”€â”€ Tooltip
    â”‚   â””â”€â”€ __tests__
    â”œâ”€â”€ constants
    â”œâ”€â”€ containers
    â”‚   â”œâ”€â”€ Editor
    â”‚   â”‚   â”œâ”€â”€ JsonEditor
    â”‚   â”‚   â””â”€â”€ LiveEditor
    â”‚   â”œâ”€â”€ Home
    â”‚   â””â”€â”€ Modals
    â”‚       â”œâ”€â”€ ClearModal
    â”‚       â”œâ”€â”€ DownloadModal
    â”‚       â”œâ”€â”€ GoalsModal
    â”‚       â”œâ”€â”€ ImportModal
    â”‚       â”œâ”€â”€ NodeModal
    â”‚       â”œâ”€â”€ SettingsModal
    â”‚       â””â”€â”€ ShareModal
    â”œâ”€â”€ hooks
    â”œâ”€â”€ pages
    â”‚   â”œâ”€â”€ Editor
    â”‚   â”œâ”€â”€ Embed
    â”‚   â””â”€â”€ Widget
    â”œâ”€â”€ store
    â”œâ”€â”€ typings
    â””â”€â”€ utils
```

### iframeå¥—å¨ƒ

ä»è¿™ä¸ªç›®å½•ï¼Œå¯ä»¥çœ‹å‡ºå®ƒæ‰€ä½¿ç”¨çš„æ¡†æ¶ä¹Ÿæ˜¯`Next.js`ï¼Œè€Œæˆ‘ä»¬ä»é¦–é¡µè¿›å…¥çš„ç¼–è¾‘å™¨æ˜¯`src/pages/Editor`ã€‚æ‰’æ‹‰æ‰’æ‹‰å¦å¤–ä¸¤ä¸ªé¡µé¢ï¼Œæˆ‘ä»¬å‘ç°`src/pages/Embed`ä¸‹è¿˜æœ‰ä¸€ä¸ªè¿™æ ·çš„é¡µé¢ â¬‡ï¸


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9719dc8b43014d57b759f8c45fa83997~tplv-k3u1fbpfcp-watermark.image?)

æ˜¯ç”¨iframeåµŒå…¥äº†ä¸€ä¸ªæ¼”ç¤ºdemoç”¨çš„[codepen](https://codepen.io/)é¡µé¢ï¼ˆ[åœ°å€](https://codepen.io/AykutSarac/embed/PoawZYo?default-tab=html%2Cresult)ï¼‰

ä»æºç åæ¨ï¼Œæˆ‘æ‰æ‰¾åˆ°ä»é¦–é¡µåˆ°`/embed`é¡µé¢çš„æ–¹æ³•ï¼šé¦–é¡µ â€”â€”â€” æ­£ä¸­é—´ â€œGO TO EDITORâ€ â€”â€”â€” å·¦ä¾§å·¥å…·æ  â€œShareâ€ â€”â€”â€” â€œLearn How to Embedâ€ã€‚ï¼ˆæ— èŠçš„æ¸¸æˆğŸ¥± ä½†å¾ˆç²¾ç¥ğŸ‘´ï¼‰

æ›´æœ‰è¶£çš„æ˜¯å¦å¤–ä¸€ä¸ªé¡µé¢ï¼š`scr/page/Widget`ã€‚

~~å› ä¸ºå®ƒæ‰“ä¸å¼€ã€‚~~

å› ä¸ºä½ å·²ç»è§è¿‡å®ƒäº†ï¼Œåªæ˜¯ä½ è¿˜ä¸çŸ¥é“ï¼

å°±åœ¨ä½ å·²ç»åˆ’è¿‡äº†çš„é‚£ä¸ªé¦–é¡µï¼

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/54c1229bf477457a8eefd6e411e5469b~tplv-k3u1fbpfcp-watermark.image?)

å®ƒæ˜¯ä¸€ä¸ªè¢«iframeåµŒå…¥çš„è¿·ä½ demoï¼

å…¶å®ä½ å¯ä»¥å…ˆå°è¯•åœ¨æµè§ˆå™¨è¾“å…¥å®ƒçš„åœ°å€ https://jsoncrack.com/widget ï¼Œç„¶åå‘ç°æˆ‘ä¹Ÿæ²¡æœ‰è¯´é”™ï¼Œå› ä¸ºç¡®å®æ‰“ä¸å¼€â€”â€”â€”å®ƒä¼šé‡å®šå‘åˆ°é¦–é¡µâ€”â€”â€”ä¸”ä¸æ˜¯å› ä¸ºâ€œèµ°é”™äº†â€ã€â€œ404â€ã€‚

ç¬¬ä¸€ï¼Œè¿™ä¸ªåœ°å€çœŸçš„å­˜åœ¨ã€‚

ç¬¬äºŒï¼Œäº‹å®è¯æ˜ï¼Œèµ°é”™äº†é•¿è¿™æ ·ï¼š

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/93874cd71c784229841342d6c27fe8c8~tplv-k3u1fbpfcp-watermark.image?)

çœ‹çœ‹ä»£ç ï¼š
```jsx
function inIframe() {
  try {
    return window.self !== window.top;
  } catch (e) {
    return true;
  }
}
// ...
if (!inIframe()) push("/");
```

æœä¸å…¶ç„¶å“ˆã€‚

åˆ¤æ–­æ˜¯å¦è¢«åµŒå…¥`iframe`çš„æ–¹æ³• +1ã€‚

æœ‰è¶£ï¼Œä¿©é¡µé¢ï¼Œä¸€ä¸ªiframeåµŒåˆ«äººï¼Œä¸€ä¸ªè¢«iframeåµŒå“ˆï¼Œæ­£å¸¸äººç¡®å®æ˜¯æ‰¾ä¸ç€å“ˆã€‚

### css in js ?!

è¿˜æ˜¯å›åˆ°æ ¸å¿ƒåŠŸèƒ½ã€‚

ä¸€è¿›æ¥å°±ç»™å­©å­çœ‹å‚»çœ¼äº†ï¼š
```tsx
export const StyledEditorWrapper = styled.div`
  width: 100%;
  height: 100%;
  overflow: hidden;
`;
```
è¿™æ˜¯ä¸ªä»€ä¹ˆç”¨æ³•ï¼Ÿï¼ˆè‡ªé—®è‡ªç­”ï¼‰è¿™æ˜¯ä¸€ä¸ªå«[`styled-components`](https://styled-components.com/)çš„åº“ã€‚è¿™æ˜¯ä¸€ä¸ªæœ€å°demoï¼š
```tsx
import styled from 'styled-components'
// ...
const Button = styled.button``
```

å…¶ä¸»è¦æ“ä½œå‘¢ï¼Œæ˜¯åœ¨`styled.button`åçš„\`\`ä¸­ï¼Œæ·»åŠ æ‰€éœ€è¦çš„cssæ ·å¼ï¼Œå°±å¯ä»¥è¿”å›å¥½çœ‹çš„ç»„ä»¶ã€‚é™¤äº†`width`ã€`height`è¿™ç§æ™®é€šçš„æ ·å¼å¤–ï¼Œè¿˜æ”¯æŒcssé€‰æ‹©å™¨ï¼ŒåŒæ—¶ï¼Œä¹Ÿå¯ä»¥ç”¨`${}`å†…çš„å‡½æ•°è¿”å›ä¸€äº›åŠ¨æ€çš„æ ·å¼ â¬‡ï¸

```tsx
import styled, { css } from 'styled-components'

const Button = styled.button`
  background: transparent;
  border-radius: 3px;
  border: 2px solid palevioletred;
  color: palevioletred;
  margin: 0 1em;
  padding: 0.25em 1em;

  ${props =>
    props.primary &&
    css`
      background: palevioletred;
      color: white;
    `};
`
```

åˆæ˜¯ä¸€ä¸ªæœ‰è¶£çš„cssæ‰“å¼€æ–¹å¼ã€‚å’Œæ˜¨å¤©**èƒ½ä¸å†™å°±ä¸å†™çš„è¯­ä¹‰åŒ–css**å®Œå…¨ç›¸åï¼Œè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„`css in js`çš„å†™æ³•ã€‚è¿™ä¸€æ€æƒ³å¯ä»¥å¾ˆå¥½çš„é¿å…ä¼ ç»Ÿcssé€ æˆçš„æ ·å¼æ±¡æŸ“é—®é¢˜ï¼Œä¹Ÿè®©æ ·å¼çš„ç»´æŠ¤å’Œæ•°æ®ä¸€æ ·æ–¹ä¾¿é›†ä¸­ï¼Œä½†ä¹Ÿé€ æˆäº†è¾ƒå¤§çš„â€œå†—ä½™â€ï¼Œå®é™…ä¸Šå¦‚ä»Šè¿™æ ·çš„æ‰“å¼€æ–¹å¼ä¼¼ä¹ä¸æ˜¯ä¸»æµã€‚

### æ¼‚äº®çš„æ¨¡å—å°è£… ğŸ“¦

```tsx
const EditorPage: React.FC = () => {
  return (
    <StyledEditorWrapper>
      <Head>
        <title>Editor | JSON Crack</title>
        <meta
          name="description"
          content="View your JSON data in graphs instantly."
        />
      </Head>
      <StyledPageWrapper>
        <Sidebar />
        <StyledEditorWrapper>
          <Panes />
        </StyledEditorWrapper>
      </StyledPageWrapper>
    </StyledEditorWrapper>
  );
};

export default EditorPage;
```

ä½œä¸ºæ ¸å¿ƒé¡µé¢çš„ä¸»è¦ä»£ç ï¼ŒçœŸæ˜¯è®©äººèµå¿ƒæ‚¦ç›®ã€‚å›å¿†ä¸€ä¸‹è¿™ä¸ªé¡µé¢çš„ç»“æ„ â¬‡ï¸

å†çœ‹çœ‹ä¸Šé¢é‚£æ®µä»£ç  â¬†ï¸

å†ç»§ç»­å¾€ä¸‹è¯» â¬‡ï¸

![https://github.com/AykutSarac/jsoncrack.com/raw/main/public/assets/jsoncrack-screenshot.webp](https://github.com/AykutSarac/jsoncrack.com/raw/main/public/assets/jsoncrack-screenshot.webp)

æ˜¯ä¸æ˜¯è®©ä½ å†·é™å†·é™ç°åœºä¸ç”¨ä¿®BUGå¥½åƒéƒ½è ¢è ¢æ¬²åŠ¨ç«‹é©¬æƒ³å¥½ä»å“ªé‡Œå¼€åˆ€äº†ï¼Ÿï¼ˆbushi

æ²¡é”™æ˜¯çš„ï¼Œå°±æ˜¯è¿™ä¹ˆæ¼‚äº®ï¼Œå¥½æƒ³æ‹‰ä¸€åˆ€ã€‚

è¿™æ ·çš„é¡¹ç›®å¾—åŠ å¤šå°‘åŠŸèƒ½æ‰èƒ½æ”¹æˆğŸ’©å‘¢ï¼Ÿ

ï¼ˆå¼€ä¸ªç©ç¬‘ï¼‰

---

æ ¸å¿ƒåŠŸèƒ½å€¼å¾—ä¸€çœ‹çš„æ— éä¸¤å¤„ï¼šå·¦è¾¹çš„JSONæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå’Œå³è¾¹çš„ç”»å¸ƒã€‚

### `Monaco` ç¼–è¾‘å™¨

æœ¬é¡¹ç›®ä¸­çš„ç¼–è¾‘å™¨ä½¿ç”¨çš„æ˜¯å¼€æºçš„[`@monaco-editor/react`](https://github.com/react-monaco-editor/react-monaco-editor)ï¼Œå¦å¤–åšäº†ä¸€ä¸ªåŠ è½½é”™è¯¯çš„å…œåº•ï¼Œå½“`Monaco`æŠ›å‡ºå¼‚å¸¸æ—¶è¿›è¡Œæç¤ºã€‚æ ¹æ®æœ¬é¡¹ç›®çš„ä½¿ç”¨ä½“éªŒæ¥è¯´ï¼Œ`Monaco`ç¼–è¾‘å™¨è¿˜æ˜¯å¾ˆå¥½ç”¨çš„ã€‚

```tsx
export const JsonEditor: React.FC = () => {
  const [hasError, setHasError] = React.useState(false);

  return (
    <StyledEditorWrapper>
      <ErrorContainer hasError={hasError} />
      <MonacoEditor setHasError={setHasError} />
    </StyledEditorWrapper>
  );
};
```

è‡³äºç¼–è¾‘å™¨å†…éƒ¨çš„é€»è¾‘ï¼Œè¿™æ¬¡å…ˆä¸ç»†çœ‹äº†ï¼Œä½†æ˜¯å¯ä»¥æŒ–ä¸ªå‘ç»™è¿™ä¸ªå¤§å‘ï¼Œä¸‹æ¬¡ä¸€å®šã€‚

### `reaflow` ç”»å¸ƒç»˜åˆ¶

æœ¬é¡¹ç›®ä¸­ç”»å¸ƒçš„åŸºç¡€åŠŸèƒ½è¿˜æ˜¯æ¯”è¾ƒå®Œå–„çš„ï¼šå¦‚ç¼©æ”¾ã€ç§»åŠ¨ã€è‡ªé€‚åº”ã€è§¦æ‘¸æ¿æ‰‹åŠ¿ã€å¯¼å‡ºå›¾ç‰‡ç­‰ï¼Œæ“ä½œä½“éªŒä¹Ÿå¾ˆæµç•…ã€‚å¦å¤–ï¼Œä¹Ÿæœ‰ä¸€äº›äº¤äº’åŠ¨æ•ˆï¼šå¦‚èŠ‚ç‚¹å’Œè¾¹çš„hoveræ•ˆæœã€èŠ‚ç‚¹ç‚¹å‡»äº‹ä»¶ï¼ˆè¾¹ç›®å‰æ²¡æœ‰ç‚¹å‡»äº‹ä»¶ï¼‰ã€‚å…¶ä¸­èŠ‚ç‚¹ä¹Ÿåˆ†ä¸ºäº†ä¸¤ä¸ªåŒºåŸŸï¼š

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/de40a3ddd45643bd89c181352393b4e1~tplv-k3u1fbpfcp-watermark.image?)

èŠ‚ç‚¹ä¸»ä½“ï¼ˆå±•ç¤ºå¯¹è±¡ä¿¡æ¯æˆ–ç±»å‹ä¸ºåˆ—è¡¨çš„å­—æ®µåï¼‰å’Œå³ä¾§å­èŠ‚ç‚¹å±•å¼€æŒ‰é’®ã€‚

å½“èŠ‚ç‚¹ä¸ºå¯¹è±¡æ—¶ï¼Œåªå±•ç¤ºèŠ‚ç‚¹ä¸»ä½“ï¼Œè€Œå¯¹è±¡ä¸­åˆ—è¡¨ç±»å‹çš„å­—æ®µåˆ™ä¼šè¢«å¤„ç†ä¸ºå¯¹è±¡èŠ‚ç‚¹çš„ä¸‹çº§èŠ‚ç‚¹ã€‚åˆ—è¡¨å­—æ®µçš„èŠ‚ç‚¹åˆ™åŒ…å«èŠ‚ç‚¹ä¸»ä½“å’Œå­èŠ‚ç‚¹å±•å¼€æ”¶èµ·æŒ‰é’®ï¼Œå¯ä»¥æ§åˆ¶å­èŠ‚ç‚¹çš„æ˜¾ç¤ºæˆ–éšè—ã€‚

æ•´ä¸ªç”»å¸ƒçš„åº•å±‚ç»˜åˆ¶ä¾èµ–äº[`reaflow`](https://reaflow.dev/)ï¼Œå…¶ä½¿ç”¨éå¸¸ä¾¿æ·ã€‚

> REAFLOW is a modular diagram engine for build static or interactive editors. The library is feature rich and modular allowing for displaying complex visualizations with total customizability.
> 
> è°·æ­Œç¿»è¯‘ï¼šREAFLOW æ˜¯ç”¨äºæ„å»ºé™æ€æˆ–äº¤äº’å¼ç¼–è¾‘å™¨çš„æ¨¡å—åŒ–å›¾è¡¨å¼•æ“ã€‚è¯¥åº“åŠŸèƒ½ä¸°å¯Œä¸”æ¨¡å—åŒ–ï¼Œå…è®¸æ˜¾ç¤ºå…·æœ‰å®Œå…¨å¯å®šåˆ¶æ€§çš„å¤æ‚å¯è§†åŒ–ã€‚

å¯ä»¥çœ‹ä¸€ä¸ªdemoï¼Œè¿™ä¹Ÿæ˜¯æœ¬é¡¹ç›®ä¸­ä½¿ç”¨`reaflow`çš„æ–¹æ³•ã€‚

```
import React from 'react';
import { Canvas } from 'reaflow';

const nodes = [
  {
    id: '1',
    text: '1'
  },
  {
    id: '2',
    text: '2'
  }
];

const edges = [
  {
    id: '1-2',
    from: '1',
    to: '2'
  }
];

export const MyDiagram = () => (
  <Canvas
    nodes={nodes}
    edges={edges}
  />
);
```

ç»˜åˆ¶ç»“æœï¼š

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/89963924dfcc4b28946c96dbe5a39916~tplv-k3u1fbpfcp-watermark.image?)

å½“ç„¶ï¼Œå¹¶éæ‰€æœ‰çš„ç”»å¸ƒèƒ½åŠ›éƒ½ç”±å®ƒæä¾›ã€‚å°½ç®¡`reaflow`ä¸­æœ‰ç¼©æ”¾æ–¹æ³•ï¼Œä½†æœ¬é¡¹ç›®ä¸­ç¦ç”¨äº†å®ƒï¼Œé€‰æ‹©äº†[`react-zoom-pan-pinch`](https://prc5.github.io/react-zoom-pan-pinch)åŒ…æä¾›çš„ç¼©æ”¾èƒ½åŠ›ã€‚

### `Storybook` ç»„ä»¶æ¡†æ¶

æœ‰è¶£çš„æ˜¯ï¼Œ`reaflow`å’Œ`react-zoom-pan-pinch`çš„æ–‡æ¡£éƒ½æ˜¯ä½¿ç”¨[`Storybook`](https://storybook.js.org/)æ­å»ºçš„ã€‚

> Storybook is a frontend workshop for building UI components and pages in isolation. Thousands of teams use it for UI development, testing, and documentation. Itâ€™s open source and free.
> 
> è°·æ­Œç¿»è¯‘ï¼šStorybook æ˜¯ä¸€ä¸ªå‰ç«¯å·¥ä½œå®¤ï¼Œç”¨äºå•ç‹¬æ„å»º UI ç»„ä»¶å’Œé¡µé¢ã€‚æ•°ä»¥åƒè®¡çš„å›¢é˜Ÿä½¿ç”¨å®ƒè¿›è¡Œ UI å¼€å‘ã€æµ‹è¯•å’Œæ–‡æ¡£ç¼–åˆ¶ã€‚å®ƒæ˜¯å¼€æºä¸”å…è´¹çš„ã€‚

é€šè¿‡`Storybook`ï¼Œå¯ä»¥è¿›è¡ŒUIç»„ä»¶çš„å¼€å‘ã€æµ‹è¯•ã€æ–‡æ¡£ç¼–å†™ï¼ˆå‡ ä¹æ˜¯å…¨æ–¹ä½äº†ï¼‰ï¼Œæ˜¯â€œç»„ä»¶é©±åŠ¨å¼€å‘â€çš„é‡è¦å·¥å…·ã€‚åŒç±»å·¥å…·ä¸­ï¼Œè¿˜æœ‰[`Docz`](https://www.docz.site/)ã€[`React Styleguidist`](https://react-styleguidist.js.org/)ã€`UMI`æ„å»ºä½“ç³»ä¸‹çš„[`dumi`](https://d.umijs.org/)ç­‰ã€‚å°±ç¬”è€…ä¸ªäººè€Œè¨€ï¼Œå› ä¸ºå·¥ä½œåŸå› ï¼Œå¯¹`dumi`çš„ä½¿ç”¨ä¼šç›¸å¯¹æ›´å¤šã€‚

`Storybook`åœ¨å…¶ä¸­åº”è¯¥ç®—æ˜¯â€œå…¨èƒ½å¤§å“¥å¤§å‹â€äº†ã€‚å®ƒæœ‰ç€75K+Starï¼Œæ”¯æŒå¤šç§æŠ€æœ¯æ ˆï¼Œç¤¾åŒºæ´»è·ƒï¼Œæ–‡æ¡£æ¥å£ä¸°å¯Œâ€¦â€¦ å¤§å‹çš„é¡¹ç›®å¾ˆæ˜¯å€¼å¾—ä¸€è¯•ï¼Œè‡³äºå°é¡¹ç›®çš„ä½“é‡æ˜¯å¦èƒ½æ‰¿å—å®ƒçš„å­¦ä¹ æˆæœ¬å°±ä¸ä¸€å®šå•¦ã€‚

### æ•°æ®ç®¡ç†

ä¸Šé¢åªæ˜¯ä¸ªé¢˜å¤–è¯ã€‚

å›åˆ°æˆ‘ä»¬çš„æ ¸å¿ƒé¡µé¢ã€‚å·¦è¾¹çš„ç¼–è¾‘å™¨ä¹Ÿçœ‹è¿‡äº†ï¼Œå³è¾¹çš„ç”»å¸ƒæ¸²æŸ“ä¹Ÿç§è¿‡äº†ï¼Œé‚£äºŒè€…ä¹‹é—´çš„æ•°æ®æ˜¯å¦‚ä½•è§£æå’Œä¼ é€’çš„å‘¢ï¼Ÿ

ç­”æ¡ˆä¹Ÿå¾ˆç®€å•ï¼š`zustand`ã€‚

##### `zustand` çŠ¶æ€ç®¡ç†

`redux`çœ‹å¤ªå¤šäº†ï¼Œæœ‰ç‚¹ä¸å¤ªè®¤è¯†å…¶ä»–çš„çŠ¶æ€ç®¡ç†å·¥å…·äº†ã€‚

> A small, fast and scalable bearbones state-management solution using simplified flux principles. Has a comfy api based on hooks, isn't boilerplatey or opinionated.
> 
> Don't disregard it because it's cute. It has quite the claws, lots of time was spent to deal with common pitfalls, like the dreadedÂ [zombie child problem](https://react-redux.js.org/api/hooks#stale-props-and-zombie-children),Â [react concurrency](https://github.com/bvaughn/rfcs/blob/useMutableSource/text/0000-use-mutable-source.md), andÂ [context loss](https://github.com/facebook/react/issues/13332)Â between mixed renderers. It may be the one state-manager in the React space that gets all of these right.
> 
> ---
> 
> ä½¿ç”¨ç®€åŒ–çš„é€šé‡åŸç†çš„å°å‹ã€å¿«é€Ÿå’Œå¯æ‰©å±•çš„ bearbones çŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚ æœ‰ä¸€ä¸ªåŸºäºhooksçš„èˆ’é€‚apiï¼Œä¸æ˜¯æ ·æ¿æ–‡ä»¶æˆ–å›ºæ‰§å·±è§ã€‚
> 
> ä¸è¦å› ä¸ºå®ƒå¯çˆ±è€Œå¿½è§†å®ƒã€‚ å®ƒæœ‰å¾ˆå¤šçˆªå­ï¼ŒèŠ±äº†å¾ˆå¤šæ—¶é—´æ¥å¤„ç†å¸¸è§çš„é™·é˜±ï¼Œæ¯”å¦‚å¯æ€•çš„åƒµå°¸å­é—®é¢˜ã€ååº”å¹¶å‘å’Œæ··åˆæ¸²æŸ“å™¨ä¹‹é—´çš„ä¸Šä¸‹æ–‡ä¸¢å¤±ã€‚ å®ƒå¯èƒ½æ˜¯ React ç©ºé—´ä¸­çš„å”¯ä¸€çŠ¶æ€ç®¡ç†å™¨ï¼Œå¯ä»¥æ­£ç¡®å¤„ç†æ‰€æœ‰è¿™äº›é—®é¢˜ã€‚

[`zustand`](https://github.com/pmndrs/zustand)åŸºäºhooksä½¿ç”¨ï¼Œçœ‹èµ·æ¥ä½¿ç”¨ä½“éªŒæ¯”`redux`è¦è½»é‡ä¸å°‘ã€‚

```tsx
import create from 'zustand'

const useBearStore = create((set) => ({
  bears: 0,
  increasePopulation: () => set((state) => ({ bears: state.bears + 1 })),
  removeAllBears: () => set({ bears: 0 }),
}))
```

çš„ç¡®ï¼Œçœ‹çœ‹å®˜æ–¹ç»™å‡ºçš„ä¼˜äº`redux`çš„ç†ç”±ï¼Œå°±ä¼šå‘ç°è½»é‡å°±æ˜¯åŸå› ä¹‹ä¸€ï¼š

> Why zustand over redux?
> -   Simple and un-opinionated
> -   Makes hooks the primary means of consuming state
> -   Doesn't wrap your app in context providers
> -   [Can inform components transiently (without causing render)](https://github.com/pmndrs/zustand#transient-updates-for-often-occurring-state-changes)
> 
> ---
> 
> ä¸ºä»€ä¹ˆ zustand è€Œä¸æ˜¯ reduxï¼Ÿ
> - ç®€å•è€Œä¸å›ºæ‰§å·±è§
> - ä½¿é’©å­æˆä¸ºæ¶ˆè´¹çŠ¶æ€çš„ä¸»è¦æ–¹å¼
> - ä¸å°†æ‚¨çš„åº”ç”¨åŒ…è£…åœ¨ä¸Šä¸‹æ–‡æä¾›ç¨‹åºä¸­
> - [å¯ä»¥ç¬æ—¶é€šçŸ¥ç»„ä»¶ï¼ˆä¸ä¼šå¯¼è‡´æ¸²æŸ“ï¼‰](https://github.com/pmndrs/zustand#transient-updates-for-often-occurring-state-changes)

##### æ•°æ®æµ

é¡¹ç›®ä¸­å…±æœ‰ä¸‰ä¸ªçŠ¶æ€æ–‡ä»¶ï¼š
```shell
src/store
â”œâ”€â”€ useConfig.tsx
â”œâ”€â”€ useGraph.tsx
â””â”€â”€ useStored.tsx
```

ä»æ ¸å¿ƒæ•°æ®æµæ¥çœ‹ï¼Œ`useConfig`ä¸­å­˜å‚¨äº†ç”¨æˆ·è¾“å…¥çš„`json`æ•°æ®ã€`useGraph`ä¸­å­˜å‚¨äº†`nodes`å’Œ`edges`æ•°æ®ã€`useStored`åˆ™ä¸æ­¤æ— å…³ã€‚

ç”¨æˆ·è¾“å…¥çš„æ•°æ®é€šè¿‡`json`ç¼–è¾‘å™¨ç»„ä»¶æ›´æ–°åˆ°`useConfig`ä¸­çš„`json`ã€‚

ä»`json`åˆ°`nodes`å’Œ`edges`ï¼Œåˆ™æ˜¯åœ¨`json`ç¼–è¾‘å™¨ç»„ä»¶å’Œ`widget`ç»„ä»¶ï¼ˆæ˜¨å¤©è¯´åˆ°çš„iframeå°çª—æ¨¡å¼ï¼Œæ­¤æ—¶æ²¡æœ‰`json`ç¼–è¾‘å™¨ï¼‰ä¸­ï¼Œå¯¹`useConfig`ä¸­`json`çš„å˜åŒ–å®æ—¶ç›‘å¬ï¼Œå¹¶æ›´æ–°åˆ°`useGraph`ä¸­çš„`nodes`å’Œ`edges`ã€‚è€Œè¿™ä¸€è¿‡ç¨‹çš„æ•°æ®å¤„ç†é€»è¾‘åˆ™å•ç‹¬å°è£…åœ¨`src/utils/jsonParser`çš„`parse`æ–¹æ³•ä¸­ï¼Œå…·ä½“å®ç°è¿˜æ˜¯æœ‰äº›å¤æ‚ï¼Œ300+è¡Œä»£ç ï¼Œæ„Ÿå…´è¶£å¯ä»¥è‡ªå·±æ‰’æ‹‰çœ‹ä¸€çœ‹ã€‚

æœ€åï¼Œç®€å•ç”¨æ—¶åºå›¾ç”»äº†ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ã€‚

```mermaid
sequenceDiagram
participant User
participant Editor
participant Widget
User->>Editor: update JSON
Editor->>useConfig: update JSON
useConfig-->>Editor: JSON updated
useConfig-->>Widget: JSON updated
Editor->>useGraph: update nodes
Editor->>useGraph: update edges
Widget->>useGraph: update nodes
Widget->>useGraph: update edges
useGraph->>Canvas: nodes updated
useGraph->>Canvas: edges updated
Canvas-->>Canvas: update canvas
```

è¿™å°±æ˜¯æœ¬é¡¹ç›®æ ¸å¿ƒåŠŸèƒ½çš„æ•°æ®æµå•¦ï¼Œé¡ºä¾¿å¤ä¹ ä¸€ä¸‹æ—¶åºå›¾å§ï¼ï¼ˆå¤§é›¾ï¼‰

---

å°å°çš„å¼€æºé¡¹ç›®ï¼Œç®€å•çš„é¡µé¢ï¼Œç®€å•çš„è¯­è¨€ï¼Œè¿˜æ˜¯æœ‰ä¸å°‘å®è—å¯æŒ–æŒ–çš„ï¼

ä»Šå¤©å°±çœ‹åˆ°è¿™é‡Œï¼Œèµ¶ç´§`âœ¨Star`æ˜å¤©ç»§ç»­ï¼
